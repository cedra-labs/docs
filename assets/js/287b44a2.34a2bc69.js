"use strict";(self.webpackChunkcedra_docs=self.webpackChunkcedra_docs||[]).push([[5359],{6321:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"nodes/stake-pool-management","title":"Running Your Validator and Joining the Network","description":"This guide continues from your validator setup journey, walking you through the final steps to activate your validator on the Cedra testnet. By completing these steps, you\'ll create a stake pool, configure your validator\'s network identity, and join the active validator set to begin earning rewards.","source":"@site/docs/nodes/stake-pool-management.md","sourceDirName":"nodes","slug":"/nodes/stake-pool-management","permalink":"/nodes/stake-pool-management","draft":false,"unlisted":false,"editUrl":"https://github.com/cedra-labs/docs/edit/main/docs/nodes/stake-pool-management.md","tags":[],"version":"current","frontMatter":{}}');var r=o(4848),t=o(8453);const i={},s="Running Your Validator and Joining the Network",d={},l=[{value:"Create Your Staking Contract",id:"create-your-staking-contract",level:2},{value:"Verify Your Stake Pool Creation",id:"verify-your-stake-pool-creation",level:2},{value:"Update Validator Network Addresses",id:"update-validator-network-addresses",level:2},{value:"Update Consensus Key for the Pool",id:"update-consensus-key-for-the-pool",level:2},{value:"Join the Validator Set",id:"join-the-validator-set",level:2},{value:"Wait for Epoch Transition",id:"wait-for-epoch-transition",level:2},{value:"Prepare Validator Identity Configuration",id:"prepare-validator-identity-configuration",level:2},{value:"Create Validator Configuration",id:"create-validator-configuration",level:2},{value:"Launch Your Validator Node",id:"launch-your-validator-node",level:2},{value:"Verify Your Validator Status",id:"verify-your-validator-status",level:2},{value:"Verify Node Operation",id:"verify-node-operation",level:2},{value:"Your Validator is Live!",id:"your-validator-is-live",level:2},{value:"Next Steps",id:"next-steps",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"running-your-validator-and-joining-the-network",children:"Running Your Validator and Joining the Network"})}),"\n",(0,r.jsx)(n.p,{children:"This guide continues from your validator setup journey, walking you through the final steps to activate your validator on the Cedra testnet. By completing these steps, you'll create a stake pool, configure your validator's network identity, and join the active validator set to begin earning rewards."}),"\n",(0,r.jsxs)(n.admonition,{title:"Prerequisites",type:"info",children:[(0,r.jsx)(n.p,{children:"Before proceeding, ensure you have:"}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Completed the ",(0,r.jsx)(n.a,{href:"./validator-setup",children:"Validator Setup and Configuration"})," guide"]}),"\n",(0,r.jsxs)(n.li,{children:["Met the ",(0,r.jsx)(n.a,{href:"./requirements",children:"system requirements"})," for running a validator node"]}),"\n",(0,r.jsx)(n.li,{children:"Funded your validator account with at least 100,001 CEDRA (100,000 for staking + 1 for transaction fees)"}),"\n"]})]}),"\n",(0,r.jsx)(n.h2,{id:"create-your-staking-contract",children:"Create Your Staking Contract"}),"\n",(0,r.jsx)(n.p,{children:"Your validator needs a staking contract to manage delegated stakes and define commission rates. This contract establishes the economic relationship between your validator and potential delegators."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Create a staking contract with your validator configuration\ncargo run --release -p cedra stake create-staking-contract \\\n  --operator <account_address> \\\n  --voter <account_address> \\\n  --amount <amount_in_octas> \\\n  --commission-percentage <percentage> \\\n  --profile owner\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example with minimum stake (100,000 CEDRA):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cargo run --release -p cedra stake create-staking-contract \\\n  --operator c8817e17ce3fabaacb695bbf6a3b600c6afbabf797960f29eaf8b88016a3f9d8 \\\n  --voter c8817e17ce3fabaacb695bbf6a3b600c6afbabf797960f29eaf8b88016a3f9d8 \\\n  --amount 10000000000000 \\\n  --commission-percentage 10 \\\n  --profile owner\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What's happening:"})," This command creates a staking contract that:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Designates your account as both the operator (who runs the validator) and voter (who participates in governance)"}),"\n",(0,r.jsx)(n.li,{children:"Stakes 100,000 CEDRA (the minimum required amount for testnet validators)"}),"\n",(0,r.jsx)(n.li,{children:"Sets a 10% commission on rewards earned by delegators"}),"\n",(0,r.jsx)(n.li,{children:"Establishes your validator's economic presence on the network"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"verify-your-stake-pool-creation",children:"Verify Your Stake Pool Creation"}),"\n",(0,r.jsx)(n.p,{children:"After creating the staking contract, a stake pool is automatically generated. You need to retrieve and save this pool address as it will be your validator's primary identifier on the network."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Retrieve your stake pool address using your owner address\ncargo run --release -p cedra node get-stake-pool --owner-address <stake_pool>\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cargo run --release -p cedra node get-stake-pool \\\n  --owner-address 0x0d74d101cc2b0b435ceef55ee7bf3af2c7658055e2ccd02d33c11f6b89d864ff\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What's happening:"})," This command queries the blockchain for your stake pool details. The returned ",(0,r.jsx)(n.code,{children:"pool_address"})," is crucial - it represents your validator's staking identity and will be used in all subsequent configuration steps. Save this address securely as you'll need it throughout the setup process."]}),"\n",(0,r.jsx)(n.h2,{id:"update-validator-network-addresses",children:"Update Validator Network Addresses"}),"\n",(0,r.jsx)(n.p,{children:"Your validator needs to broadcast its network endpoints to other validators. This step registers your validator's communication addresses with the stake pool."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Update network addresses for your stake pool\ncargo run --release -p cedra node update-validator-network-addresses \\\n  --pool-address <pool_address> \\\n  --operator-config-file <path-to-operator>/genesis/v1/operator.yaml \\\n  --profile owner\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cargo run --release -p cedra node update-validator-network-addresses \\\n  --pool-address 0x0d74d101cc2b0b435ceef55ee7bf3af2c7658055e2ccd02d33c11f6b89d864ff \\\n  --operator-config-file cedra-network/net/v1/operator.yaml \\\n  --profile owner\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What's happening:"})," This command publishes your validator's network configuration on-chain, allowing other validators to discover and connect to your node. It uses the operator configuration file generated during initial setup to ensure consistent network identity."]}),"\n",(0,r.jsx)(n.h2,{id:"update-consensus-key-for-the-pool",children:"Update Consensus Key for the Pool"}),"\n",(0,r.jsx)(n.p,{children:"Your validator's consensus key enables participation in the block production process. You'll need to extract this key from your operator configuration and register it with your stake pool."}),"\n",(0,r.jsx)(n.p,{children:"First, locate your consensus public key:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Navigate to your validator configuration directory\ncd net/v1\n\n# Open operator.yaml and find the consensus_public_key value\ncat operator.yaml | grep consensus_public_key\n"})}),"\n",(0,r.jsx)(n.p,{children:"Now update your stake pool with this consensus key:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Register the consensus key with your stake pool\ncargo run --release -p cedra node update-consensus-key \\\n  --consensus-public-key <consensus_public_key> \\\n  --pool-address <pool_address> \\\n  --operator-config-file <path-to-operator>/genesis/v1/operator.yaml \\\n  --profile owner\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cargo run --release -p cedra node update-consensus-key \\\n  --consensus-public-key 0x85a21ab7c8850b1fc49da0520d490e9cbb71e4a0ebd0d68aa6aeea8d3932810eda91dabbdcf44537b207ee0e66fef03e \\\n  --pool-address 0x0d74d101cc2b0b435ceef55ee7bf3af2c7658055e2ccd02d33c11f6b89d864ff \\\n  --operator-config-file cedra-network/net/v1/operator.yaml \\\n  --profile owner\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What's happening:"})," This command links your validator's consensus key to your stake pool, enabling your validator to sign blocks and participate in consensus. This cryptographic binding ensures only your validator can act on behalf of your stake pool."]}),"\n",(0,r.jsx)(n.h2,{id:"join-the-validator-set",children:"Join the Validator Set"}),"\n",(0,r.jsx)(n.p,{children:"With all configurations in place, it's time to officially request admission to the validator set. This is the moment your validator becomes eligible to participate in consensus."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Submit your request to join the active validator set\ncargo run --release -p cedra node join-validator-set \\\n  --pool-address <pool_address> \\\n  --profile owner\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cargo run --release -p cedra node join-validator-set \\\n  --pool-address 0x0d74d101cc2b0b435ceef55ee7bf3af2c7658055e2ccd02d33c11f6b89d864ff \\\n  --profile owner\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What's happening:"})," This command submits a transaction to add your stake pool to the pending validator set. Your validator will become active at the beginning of the next epoch, when the network rotates its validator set."]}),"\n",(0,r.jsx)(n.h2,{id:"wait-for-epoch-transition",children:"Wait for Epoch Transition"}),"\n",(0,r.jsx)(n.p,{children:"The Cedra network operates in epochs, with validator set changes occurring at epoch boundaries. Your validator won't become active immediately - you must wait for the next epoch to begin."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Check the current epoch:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Query the network for current epoch information\ncurl https://testnet.cedra.dev/v1\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Look for the ",(0,r.jsx)(n.code,{children:'"epoch"'})," field in the JSON response. Epochs on testnet rotate approximately every 2 hours."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What's happening:"})," The network processes validator set changes in batches at epoch boundaries to maintain stability. This prevents constant network disruptions from validators joining or leaving. Monitor the epoch number and wait for it to increment before proceeding."]}),"\n",(0,r.jsx)(n.h2,{id:"prepare-validator-identity-configuration",children:"Prepare Validator Identity Configuration"}),"\n",(0,r.jsx)(n.p,{children:"Your validator needs a modified identity file that references the stake pool instead of your personal account. This separation enhances security by removing sensitive keys from the operational configuration."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Navigate to your validator directory\ncd net/v1\n\n# Create a copy of your validator identity for pool operations\ncp validator-identity.yaml validator-identity-v2.yaml\n\n# Edit the new file to:\n# 1. Remove the line containing 'account_private_key' (for security)\n# 2. Replace the account_address value with your pool_address\nnano validator-identity-v2.yaml\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What's happening:"})," You're creating a specialized identity file for your validator that:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Removes the private key to prevent accidental exposure"}),"\n",(0,r.jsx)(n.li,{children:"Links your validator directly to the stake pool address"}),"\n",(0,r.jsx)(n.li,{children:"Maintains all necessary public keys for network operations"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This configuration allows your validator to operate without exposing sensitive account credentials."}),"\n",(0,r.jsx)(n.h2,{id:"create-validator-configuration",children:"Create Validator Configuration"}),"\n",(0,r.jsx)(n.p,{children:"Your validator needs a comprehensive configuration file that defines how it operates, connects to the network, and manages consensus participation."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Navigate to your validator directory\ncd net/v1\n\n# Create the main validator configuration file\nnano validator.yaml\n"})}),"\n",(0,r.jsx)(n.p,{children:"Add the following configuration:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'base:\n  data_dir: "data_validator"\n  role: "validator"\n  waypoint:\n    from_file: "../genesis/waypoint.txt"\nconsensus:\n  safety_rules:\n    service:\n      type: "local"\n    backend:\n      type: "on_disk_storage"\n      path: "./secure-data.json"\n      namespace: ~\n    initial_safety_rules_config:\n      from_file:\n        waypoint:\n          from_file: "../genesis/waypoint.txt"\n        identity_blob_path: "validator-identity-v2.yaml"\nexecution:\n  genesis_file_location: "../genesis/genesis.blob"\nvalidator_network:\n  discovery_method: "onchain"\n  listen_address: "/ip4/0.0.0.0/tcp/6182"\n  identity:\n    type: "from_file"\n    path: "validator-identity-v2.yaml"\n  network_id: "validator"\n  mutual_authentication: true\n  max_frame_size: 4194304 # 4 MiB\n  seeds:\n    31f1ff7f7bb3761f26db76abbc80a8be42a16d2c031801b8c9704f4e7a747a24:\n      addresses:\n      - "/dns/t-seed.cedra.dev/tcp/6174/noise-ik/0x1a9410775bec1fa1b8ad771a6e70ca66a4451f22045420dd88c4b134c23bec27/handshake/0"\n      role: "Validator"\nadmin_service:\n  port: 9107\ninspection_service:\n  port: 9108\napi:\n  enabled: true\n  address: 127.0.0.1:8080\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What's happening:"})," This configuration file orchestrates your entire validator operation:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Base"}),": Defines data storage location and network waypoint for synchronization"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Consensus"}),": Configures the safety rules that prevent double-signing and slashing"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Execution"}),": Points to the genesis file for initial state"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Validator Network"}),": Sets up peer discovery, authentication, and seed nodes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Services"}),": Enables admin, inspection, and API endpoints for monitoring"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"launch-your-validator-node",children:"Launch Your Validator Node"}),"\n",(0,r.jsx)(n.p,{children:"With all configurations complete, it's time to start your validator and begin participating in network consensus."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Start your validator node\ncedra-node --config validator.yaml\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What's happening:"})," Your validator node is now:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Connecting to the Cedra testnet through seed nodes"}),"\n",(0,r.jsx)(n.li,{children:"Synchronizing with the current blockchain state"}),"\n",(0,r.jsx)(n.li,{children:"Preparing to participate in consensus once your stake pool is active"}),"\n",(0,r.jsx)(n.li,{children:"Listening for incoming connections from other validators"}),"\n",(0,r.jsx)(n.li,{children:"Ready to propose and validate blocks"}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{title:"Validator Activated",type:"success",children:(0,r.jsx)(n.p,{children:"Your validator is now running and will begin participating in consensus at the next epoch! Monitor your logs to ensure successful synchronization and network connectivity."})}),"\n",(0,r.jsx)(n.h2,{id:"verify-your-validator-status",children:"Verify Your Validator Status"}),"\n",(0,r.jsx)(n.p,{children:"Once your validator is running, verify its operational status and stake pool configuration:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Check your validator's stake pool status\ncargo run --release -p cedra node get-stake-pool \\\n  --owner-address 0x0d74d101cc2b0b435ceef55ee7bf3af2c7658055e2ccd02d33c11f6b89d864ff\n"})}),"\n",(0,r.jsx)(n.p,{children:"This command displays:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Your pool's current stake amount"}),"\n",(0,r.jsx)(n.li,{children:"Active/inactive status"}),"\n",(0,r.jsx)(n.li,{children:"Current delegations"}),"\n",(0,r.jsx)(n.li,{children:"Earned rewards"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"verify-node-operation",children:"Verify Node Operation"}),"\n",(0,r.jsx)(n.p,{children:"To confirm your validator node is running correctly and synchronized with the network:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Check your local node's API endpoint\ncurl http://localhost:8080/v1\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Or open ",(0,r.jsx)(n.code,{children:"http://localhost:8080/v1"})," in your browser."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"What to look for:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The ",(0,r.jsx)(n.code,{children:'"epoch"'})," field should show a value greater than 1 within 2 hours after starting your node"]}),"\n",(0,r.jsxs)(n.li,{children:["The ",(0,r.jsx)(n.code,{children:'"ledger_version"'})," should be increasing, indicating your node is processing blocks"]}),"\n",(0,r.jsxs)(n.li,{children:["The ",(0,r.jsx)(n.code,{children:'"chain_id"'})," should match the testnet chain identifier"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"If the epoch remains at 0 or 1 after 2 hours, your node may still be synchronizing. Check your validator logs for any connection or synchronization issues."}),"\n",(0,r.jsx)(n.h2,{id:"your-validator-is-live",children:"Your Validator is Live!"}),"\n",(0,r.jsx)(n.p,{children:"Congratulations! You've successfully:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u2705 Created a staking contract with your initial stake"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Configured your stake pool for delegation"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Registered your validator's network addresses"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Updated consensus keys for block production"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Joined the pending validator set"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Prepared secure operational configurations"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Launched your validator node"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Your validator is now an active participant in securing the Cedra testnet, validating transactions, producing blocks, and earning staking rewards for you and your delegators."}),"\n",(0,r.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsx)(n.p,{children:"Monitor your validator's performance and maintain high uptime to maximize rewards. Consider:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Setting up monitoring and alerting systems"}),"\n",(0,r.jsx)(n.li,{children:"Implementing automatic restart mechanisms"}),"\n",(0,r.jsx)(n.li,{children:"Backing up your validator keys securely"}),"\n",(0,r.jsx)(n.li,{children:"Engaging with the validator community for best practices"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Welcome to the Cedra validator ecosystem! \ud83c\udf89"})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>i,x:()=>s});var a=o(6540);const r={},t=a.createContext(r);function i(e){const n=a.useContext(t);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),a.createElement(t.Provider,{value:n},e.children)}}}]);