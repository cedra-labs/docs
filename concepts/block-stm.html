<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-concepts/block-stm" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Block-STM: Parallel Execution Engine | Cedra Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.cedra.network/concepts/block-stm"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Block-STM: Parallel Execution Engine | Cedra Docs"><meta data-rh="true" name="description" content="Cedra achieves high throughput through Block-STM, a parallel execution engine that processes transactions concurrently while maintaining deterministic results. This technology enables over 160,000 transactions per second by combining Software Transactional Memory techniques with a novel collaborative scheduler."><meta data-rh="true" property="og:description" content="Cedra achieves high throughput through Block-STM, a parallel execution engine that processes transactions concurrently while maintaining deterministic results. This technology enables over 160,000 transactions per second by combining Software Transactional Memory techniques with a novel collaborative scheduler."><link data-rh="true" rel="icon" href="/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.cedra.network/concepts/block-stm"><link data-rh="true" rel="alternate" href="https://docs.cedra.network/concepts/block-stm" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.cedra.network/concepts/block-stm" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://6L20AENCYF-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QJ1YFC04H0"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-QJ1YFC04H0",{anonymize_ip:!0})</script>



<link rel="search" type="application/opensearchdescription+xml" title="Cedra Docs" href="/opensearch.xml">

<meta name="algolia-site-verification" content="91148BBB2BA8D18D"><link rel="stylesheet" href="/assets/css/styles.1fc597bd.css">
<script src="/assets/js/runtime~main.8d2f0c05.js" defer="defer"></script>
<script src="/assets/js/main.1ecc99c4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMjAwIDQwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogIDx0ZXh0IHg9IjAiIHk9IjMwIiBmb250LWZhbWlseT0iSW50ZXIsIEFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXdlaWdodD0iNzAwIiBmb250LXNpemU9IjI4IiBmaWxsPSIjMTExODI3Ij5DRURSQTwvdGV4dD4KICA8dGV4dCB4PSIxMDUiIHk9IjMwIiBmb250LWZhbWlseT0iSW50ZXIsIEFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXdlaWdodD0iNDAwIiBmb250LXNpemU9IjE0IiBmaWxsPSIjNmI3MjgwIj5kZXZlbG9wZXJzPC90ZXh0Pgo8L3N2Zz4=" alt="CEDRA developers" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMjAwIDQwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogIDx0ZXh0IHg9IjAiIHk9IjMwIiBmb250LWZhbWlseT0iSW50ZXIsIEFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXdlaWdodD0iNzAwIiBmb250LXNpemU9IjI4IiBmaWxsPSIjZmZmZmZmIj5DRURSQTwvdGV4dD4KICA8dGV4dCB4PSIxMDUiIHk9IjMwIiBmb250LWZhbWlseT0iSW50ZXIsIEFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXdlaWdodD0iNDAwIiBmb250LXNpemU9IjE0IiBmaWxsPSIjOTRhM2I4Ij5kZXZlbG9wZXJzPC90ZXh0Pgo8L3N2Zz4=" alt="CEDRA developers" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/concepts">Concepts</a></div><div class="navbar__items navbar__items--right"><a href="https://tally.so/r/nWavBe" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__item--contrast">Feedback</a><a href="https://github.com/cedra-labs/move-contract-examples" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Code Examples<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/concepts">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/concepts/blockchain">Blockchain</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/concepts/block-stm">Block-STM Parallel Execution</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/concepts/accounts/understanding-accounts">Accounts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/concepts/transactions/understanding-transactions">Transactions</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Block-STM Parallel Execution</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Block-STM: Parallel Execution Engine</h1></header>
<p>Cedra achieves high throughput through Block-STM, a parallel execution engine that processes transactions concurrently while maintaining deterministic results. This technology enables over 160,000 transactions per second by combining Software Transactional Memory techniques with a novel collaborative scheduler.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="key-concepts">Key Concepts<a href="#key-concepts" class="hash-link" aria-label="Direct link to Key Concepts" title="Direct link to Key Concepts">​</a></h3>
<ul>
<li><strong><a href="#how-block-stm-works">Parallel Execution</a></strong>: Running multiple transactions simultaneously</li>
<li><strong><a href="#optimistic-vs-pessimistic-concurrency">Optimistic Concurrency Control</a></strong>: Execute first, validate later</li>
<li><strong><a href="#multi-version-data-structure">Multi-version Data Structure</a></strong>: Track all writes with versions</li>
<li><strong><a href="#the-collaborative-scheduler">Collaborative Scheduler</a></strong>: Coordinate tasks across threads</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-concurrency-challenge">The Concurrency Challenge<a href="#the-concurrency-challenge" class="hash-link" aria-label="Direct link to The Concurrency Challenge" title="Direct link to The Concurrency Challenge">​</a></h2>
<p>Smart contract execution is a major throughput bottleneck for blockchains. After proposing blocks and agreeing on their order, validators must execute the transactions and arrive at the same final state - one that corresponds to some sequential execution. This creates a fundamental tension: we want parallel execution for speed, but we need deterministic results for consensus.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Core Principle</div><div class="admonitionContent_BuS1"><p>Block-STM guarantees that parallel execution produces the same result as if transactions were executed sequentially in the preset order. This determinism is essential - validators executing the same block must arrive at identical final states.</p></div></div>
<p>Current blockchains face a difficult choice: execute sequentially (which doesn&#x27;t scale) or require an embarrassingly parallel workload with no conflicts (which is unrealistic for real applications). Transactions often have significant access conflicts due to popular contracts, economic opportunities like auctions and arbitrage, or even performance attacks.</p>
<p>Block-STM solves this by dynamically and transparently extracting the inherent parallelism from any workload, without requiring users to declare dependencies upfront.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="optimistic-vs-pessimistic-concurrency">Optimistic vs Pessimistic Concurrency<a href="#optimistic-vs-pessimistic-concurrency" class="hash-link" aria-label="Direct link to Optimistic vs Pessimistic Concurrency" title="Direct link to Optimistic vs Pessimistic Concurrency">​</a></h2>
<p>There are two fundamental approaches to handling concurrent access to shared resources:</p>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pessimistic-concurrency-control-pcc">Pessimistic Concurrency Control (PCC)<a href="#pessimistic-concurrency-control-pcc" class="hash-link" aria-label="Direct link to Pessimistic Concurrency Control (PCC)" title="Direct link to Pessimistic Concurrency Control (PCC)">​</a></h3>
<p>In PCC systems like Solana, transactions are blocked if they need to access a resource already in use by another transaction. This approach requires transactions to declare upfront what portions of memory they will read from and write to, since acquiring locks on the fly leads to unserializable execution results.</p>
<p>While PCC has historically performed well in distributed databases, it comes with significant limitations: users must specify all dependencies before execution, which constrains what transactions can do and may require complex transactions to be broken up or retried.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="optimistic-concurrency-control-occ">Optimistic Concurrency Control (OCC)<a href="#optimistic-concurrency-control-occ" class="hash-link" aria-label="Direct link to Optimistic Concurrency Control (OCC)" title="Direct link to Optimistic Concurrency Control (OCC)">​</a></h3>
<p>Block-STM uses OCC, where transactions execute on all available processing resources with no regard for conflicts. Instead of writing directly to persistent memory, transactions write to a log. After execution, each transaction is validated to ensure it didn&#x27;t violate database integrity rules. If validation fails, the transaction is rolled back and rescheduled; otherwise, it commits.</p>
<table><thead><tr><th>Aspect</th><th>PCC (Solana)</th><th>OCC (Block-STM)</th></tr></thead><tbody><tr><td><strong>Dependency Declaration</strong></td><td>Required upfront</td><td>Not required</td></tr><tr><td><strong>Execution</strong></td><td>Blocked if resource locked</td><td>Proceeds optimistically</td></tr><tr><td><strong>Conflict Detection</strong></td><td>Before execution</td><td>After execution</td></tr><tr><td><strong>Developer Experience</strong></td><td>Must specify all accessed accounts</td><td>Transparent, automatic</td></tr><tr><td><strong>Arbitrary Logic</strong></td><td>Limited by declarations</td><td>Fully supported</td></tr></tbody></table>
<p>Thanks to clever design and engineering, Block-STM performs surprisingly well, with the added benefits of allowing arbitrary logic and a superior developer experience.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-block-stm-works">How Block-STM Works<a href="#how-block-stm-works" class="hash-link" aria-label="Direct link to How Block-STM Works" title="Direct link to How Block-STM Works">​</a></h2>
<p>Block-STM combines known techniques with novel ideas to achieve high-performance parallel execution:</p>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="transaction-ordering">Transaction Ordering<a href="#transaction-ordering" class="hash-link" aria-label="Direct link to Transaction Ordering" title="Direct link to Transaction Ordering">​</a></h3>
<p>Before execution begins, transactions are ordered by priority: <code>tx₁ &gt; tx₂ &gt; tx₃ &gt; ... &gt; txₙ</code>. This preset order is crucial - it reduces the amount of synchronization required during execution. Where a general-purpose STM would need to solve consensus when conflicts occur, Block-STM simply follows the predetermined order: if tx₅ and tx₉ conflict, tx₉ waits for tx₅.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="multi-version-data-structure">Multi-Version Data Structure<a href="#multi-version-data-structure" class="hash-link" aria-label="Direct link to Multi-Version Data Structure" title="Direct link to Multi-Version Data Structure">​</a></h3>
<p>Block-STM uses a multi-version data structure to avoid write-write conflicts. All writes to the same location are stored along with their versions, which contain:</p>
<ul>
<li>The transaction ID</li>
<li>The number of times the writing transaction was re-executed</li>
</ul>
<p>When a transaction <code>txⱼ</code> reads a memory location, it obtains the value written by the highest-priority transaction that appears before <code>txⱼ</code> in the preset order, along with the associated version.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="read-set-tracking">Read Set Tracking<a href="#read-set-tracking" class="hash-link" aria-label="Direct link to Read Set Tracking" title="Direct link to Read Set Tracking">​</a></h3>
<p>During execution, each transaction records its read set - the memory locations and associated values it read. This information is essential for validation.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="validation-process">Validation Process<a href="#validation-process" class="hash-link" aria-label="Direct link to Validation Process" title="Direct link to Validation Process">​</a></h3>
<p>After a transaction completes execution, it&#x27;s validated by comparing its read set with the current values at those memory locations:</p>
<ul>
<li><strong>If values match</strong>: The transaction is marked valid (but not yet safe to commit)</li>
<li><strong>If values differ</strong>: A higher-priority transaction modified a location that this transaction read, making the results invalid</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="conflict-resolution-with-estimate">Conflict Resolution with ESTIMATE<a href="#conflict-resolution-with-estimate" class="hash-link" aria-label="Direct link to Conflict Resolution with ESTIMATE" title="Direct link to Conflict Resolution with ESTIMATE">​</a></h3>
<p>When validation fails, instead of deleting dirty values from the data structure, Block-STM marks them as <code>ESTIMATE</code> and schedules the transaction for re-execution. This is a key optimization:</p>
<ul>
<li>Values aren&#x27;t deleted because re-execution will likely write to the same locations</li>
<li>Any lower-priority transaction that reads an <code>ESTIMATE</code> value waits for the dependency to be resolved</li>
<li>This prevents a cascade of aborts and wasted work</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-collaborative-scheduler">The Collaborative Scheduler<a href="#the-collaborative-scheduler" class="hash-link" aria-label="Direct link to The Collaborative Scheduler" title="Direct link to The Collaborative Scheduler">​</a></h2>
<p>The collaborative scheduler is the performance-critical core of Block-STM. It coordinates validation and execution tasks among threads with minimal synchronization overhead.</p>
<!-- -->
<p>A naive approach would use priority queues to track execution and validation tasks, but concurrent ordered sets are notoriously challenging to scale. Block-STM sidesteps this by using atomic counters that track a lower bound index for transactions needing execution or validation.</p>
<p>Threads repeatedly:</p>
<ol>
<li>Fetch-and-increment the counter with the lower index</li>
<li>Check the transaction&#x27;s status</li>
<li>Execute or validate if the transaction is ready</li>
</ol>
<p>The fetch-and-increment naturally disperses threads to different indices, preventing contention on status information.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="avoiding-cascading-aborts">Avoiding Cascading Aborts<a href="#avoiding-cascading-aborts" class="hash-link" aria-label="Direct link to Avoiding Cascading Aborts" title="Direct link to Avoiding Cascading Aborts">​</a></h3>
<p>When a transaction fails validation, its write set marks all its writes as <code>ESTIMATE</code> in the multi-version data structure. When another transaction reads an <code>ESTIMATE</code> value, it waits for the dependency to be resolved rather than proceeding blindly.</p>
<p>This is more efficient than pre-executing all transactions from the initial state because:</p>
<ul>
<li>Estimates are generated only when needed</li>
<li>Estimates are based on a state much fresher than the block&#x27;s beginning</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="transaction-lifecycle-in-block-stm">Transaction Lifecycle in Block-STM<a href="#transaction-lifecycle-in-block-stm" class="hash-link" aria-label="Direct link to Transaction Lifecycle in Block-STM" title="Direct link to Transaction Lifecycle in Block-STM">​</a></h2>
<!-- -->
<ol>
<li><strong>Submission</strong>: Client sends transaction to a fullnode or validator</li>
<li><strong>Mempool</strong>: Nodes verify signatures, minimum balances, and sequence numbers for replay protection</li>
<li><strong>Block Proposal</strong>: Leader selects transactions and proposes an ordering</li>
<li><strong>Parallel Execution</strong>: Transactions execute concurrently on available threads</li>
<li><strong>Validation</strong>: Each transaction&#x27;s read set is compared against current values</li>
<li><strong>Re-execution</strong>: Invalid transactions are rescheduled with <code>ESTIMATE</code> markers</li>
<li><strong>Commitment</strong>: Once all prior transactions are valid, the block commits</li>
</ol>
<p>A transaction is not safe to commit until all transactions before it in the preset order have been executed and validated - a failed validation of an earlier transaction requires revalidation of all later ones.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="performance-characteristics">Performance Characteristics<a href="#performance-characteristics" class="hash-link" aria-label="Direct link to Performance Characteristics" title="Direct link to Performance Characteristics">​</a></h2>
<p>Block-STM achieves remarkable performance by dynamically adapting to workload characteristics:</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Performance Results</div><div class="admonitionContent_BuS1"><p>With 32 threads processing 10,000 peer-to-peer Move transactions (8 reads, 5 writes each):</p><ul>
<li><strong>Low contention</strong>: 16x speedup over sequential execution</li>
<li><strong>High contention</strong>: 8x speedup over sequential execution</li>
<li><strong>Sequential workload</strong>: Minimal overhead</li>
</ul></div></div>
<p>The system automatically extracts available parallelism without hints from users. Under low contention, it approaches the theoretical maximum speedup. Under high contention, it gracefully degrades while still providing substantial improvements over sequential execution.</p>
<p>Importantly, when the workload is inherently sequential (worst case), Block-STM incurs only small overhead compared to sequential execution.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-this-matters-for-developers">Why This Matters for Developers<a href="#why-this-matters-for-developers" class="hash-link" aria-label="Direct link to Why This Matters for Developers" title="Direct link to Why This Matters for Developers">​</a></h2>
<p>Block-STM provides transparent parallel execution - developers write smart contracts without worrying about concurrency:</p>
<p><strong>No Dependency Declarations</strong>: Unlike systems that require upfront specification of accessed accounts, Block-STM handles everything automatically. Write your logic; the system figures out the rest.</p>
<p><strong>Arbitrary Logic Supported</strong>: Because dependencies are discovered at runtime, transactions can contain complex, conditional logic that accesses different resources based on state.</p>
<p><strong>Better User Experience</strong>: Users don&#x27;t need to structure their transactions around parallelization requirements or retry failed transactions due to incorrect dependency specifications.</p>
<p><strong>Consistent Results</strong>: Despite parallel execution, the results are guaranteed to match sequential execution in the preset order - perfect for blockchain&#x27;s determinism requirements.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary">​</a></h2>
<p>Block-STM is Cedra&#x27;s parallel execution engine that achieves high throughput without sacrificing developer experience or flexibility:</p>
<ul>
<li><strong>Optimistic execution</strong> proceeds without waiting for locks, validating afterward</li>
<li><strong>Multi-version data structures</strong> track all writes with versions for conflict detection</li>
<li><strong>ESTIMATE markers</strong> prevent cascading aborts when conflicts are detected</li>
<li><strong>Collaborative scheduling</strong> with atomic counters minimizes synchronization overhead</li>
<li><strong>Preset ordering</strong> simplifies conflict resolution and guarantees determinism</li>
<li><strong>Transparent operation</strong> requires no dependency declarations from developers</li>
</ul>
<p>The result: over 160,000 transactions per second with the flexibility to support arbitrary smart contract logic.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="learn-more">Learn More<a href="#learn-more" class="hash-link" aria-label="Direct link to Learn More" title="Direct link to Learn More">​</a></h2>
<ul>
<li><a href="/concepts/blockchain">Blockchain Architecture</a> - Overall system design</li>
<li><a href="/concepts/transactions/understanding-transactions">Understanding Transactions</a> - Transaction structure and lifecycle</li>
<li><a href="/concepts/transactions/states">States and Transitions</a> - How state evolves</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/cedra-labs/docs/edit/main/docs/concepts/block-stm.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/concepts/blockchain"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Blockchain</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/concepts/accounts/understanding-accounts"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Understanding Accounts</div></a></nav></div></div><div class="col col--3"><div class="toc-wrapper"><div class="toc-edit-button"><a href="https://github.com/cedra-labs/docs/edit/main/docs/concepts/block-stm.md" target="_blank" rel="noopener noreferrer" class="edit-page-link"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg><span>Edit page</span><svg width="13" height="13" viewBox="0 0 13 13" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="external-link-icon"><path d="M1.5 1.5L11.5 1.5V11.5" stroke="currentColor" stroke-width="1.5" fill="none"></path><path d="M11.5 1.5L1.5 11.5" stroke="currentColor" stroke-width="1.5" fill="none"></path></svg></a></div><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#key-concepts" class="table-of-contents__link toc-highlight">Key Concepts</a></li><li><a href="#the-concurrency-challenge" class="table-of-contents__link toc-highlight">The Concurrency Challenge</a></li><li><a href="#optimistic-vs-pessimistic-concurrency" class="table-of-contents__link toc-highlight">Optimistic vs Pessimistic Concurrency</a><ul><li><a href="#pessimistic-concurrency-control-pcc" class="table-of-contents__link toc-highlight">Pessimistic Concurrency Control (PCC)</a></li><li><a href="#optimistic-concurrency-control-occ" class="table-of-contents__link toc-highlight">Optimistic Concurrency Control (OCC)</a></li></ul></li><li><a href="#how-block-stm-works" class="table-of-contents__link toc-highlight">How Block-STM Works</a><ul><li><a href="#transaction-ordering" class="table-of-contents__link toc-highlight">Transaction Ordering</a></li><li><a href="#multi-version-data-structure" class="table-of-contents__link toc-highlight">Multi-Version Data Structure</a></li><li><a href="#read-set-tracking" class="table-of-contents__link toc-highlight">Read Set Tracking</a></li><li><a href="#validation-process" class="table-of-contents__link toc-highlight">Validation Process</a></li><li><a href="#conflict-resolution-with-estimate" class="table-of-contents__link toc-highlight">Conflict Resolution with ESTIMATE</a></li></ul></li><li><a href="#the-collaborative-scheduler" class="table-of-contents__link toc-highlight">The Collaborative Scheduler</a><ul><li><a href="#avoiding-cascading-aborts" class="table-of-contents__link toc-highlight">Avoiding Cascading Aborts</a></li></ul></li><li><a href="#transaction-lifecycle-in-block-stm" class="table-of-contents__link toc-highlight">Transaction Lifecycle in Block-STM</a></li><li><a href="#performance-characteristics" class="table-of-contents__link toc-highlight">Performance Characteristics</a></li><li><a href="#why-this-matters-for-developers" class="table-of-contents__link toc-highlight">Why This Matters for Developers</a></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li><li><a href="#learn-more" class="table-of-contents__link toc-highlight">Learn More</a></li></ul></div></div></div></div></div></main></div></div></div></div>
</body>
</html>